function T = forwKinematics_d(DH,Rpol, Rbod)
    [numDOF,~] = size(DH);
    %DH in standard form, colums are: d,theta,r,alpha
    d = DH(:,1);
    r = DH(:,3);
    s_t = zeros(4,1);
    c_t = zeros(4,1);
    s_a = zeros(4,1);
    c_a = zeros(4,1);
    for i=1:numDOF
        s_t(i) = sin(DH(i,2));
        c_t(i) = cos(DH(i,2));
        s_a(i) = sin(DH(i,4));
        c_a(i) = cos(DH(i,4));
    end
    x_p = Rpol(1);
    y_p = Rpol(2);
    z_p = Rpol(3);
    c_u = cos(Rpol(4)); s_u = sin(Rpol(4));
    c_v = cos(Rpol(5)); s_v = sin(Rpol(5));
    c_w = cos(Rpol(6)); s_w = sin(Rpol(6));

    c_p = cos(Rbod(1)); s_p = sin(Rbod(1));
    c_q = cos(Rbod(2)); s_q = sin(Rbod(2));
    c_r = cos(Rbod(3)); s_r = sin(Rbod(3));

   %T = 6x1 vector; x,y,z,phi,theta,psi
  T = [x_p + s_v*(d(1) + s_a(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + c_a(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) + c_v*c_w*(c_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*c_t(1) - c_a(1)*s_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + s_a(1)*s_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) - c_v*s_w*(s_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*s_t(1) + c_a(1)*c_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) - s_a(1)*c_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3)));
      y_p + (c_u*s_w + c_w*s_u*s_v)*(c_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*c_t(1) - c_a(1)*s_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + s_a(1)*s_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) + (c_u*c_w - s_u*s_v*s_w)*(s_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*s_t(1) + c_a(1)*c_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) - s_a(1)*c_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) - c_v*s_u*(d(1) + s_a(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + c_a(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3)));
      z_p + (c_w*s_u + c_u*s_v*s_w)*(s_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*s_t(1) + c_a(1)*c_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) - s_a(1)*c_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) + (s_u*s_w - c_u*c_w*s_v)*(c_t(1)*(r(2)*c_t(2) + d(3)*s_a(2)*s_t(2) + r(3)*c_t(2)*c_t(3) - r(3)*c_a(2)*s_t(2)*s_t(3)) + r(1)*c_t(1) - c_a(1)*s_t(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + s_a(1)*s_t(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3))) + c_u*c_v*(d(1) + s_a(1)*(r(2)*s_t(2) - d(3)*s_a(2)*c_t(2) + r(3)*c_t(3)*s_t(2) + r(3)*c_a(2)*c_t(2)*s_t(3)) + c_a(1)*(d(2) + d(3)*c_a(2) + r(3)*s_a(2)*s_t(3)));
      atan(((c_w*s_u + c_u*s_v*s_w)*(s_t(1)*(c_a(2)*s_t(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) - c_t(2)*(c_a(3)*s_t(3)*(c_p*c_r - s_p*s_q*s_r) - s_a(3)*s_t(3)*(c_r*s_p + c_p*s_q*s_r) + c_q*c_t(3)*s_r) + s_a(2)*s_t(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r))) + s_a(1)*c_t(1)*(s_a(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) - c_a(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r))) - c_a(1)*c_t(1)*(s_t(2)*(c_a(3)*s_t(3)*(c_p*c_r - s_p*s_q*s_r) - s_a(3)*s_t(3)*(c_r*s_p + c_p*s_q*s_r) + c_q*c_t(3)*s_r) + c_a(2)*c_t(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) + s_a(2)*c_t(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r)))) + (s_u*s_w - c_u*c_w*s_v)*(c_t(1)*(c_a(2)*s_t(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) - c_t(2)*(c_a(3)*s_t(3)*(c_p*c_r - s_p*s_q*s_r) - s_a(3)*s_t(3)*(c_r*s_p + c_p*s_q*s_r) + c_q*c_t(3)*s_r) + s_a(2)*s_t(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r))) + c_a(1)*s_t(1)*(s_t(2)*(c_a(3)*s_t(3)*(c_p*c_r - s_p*s_q*s_r) - s_a(3)*s_t(3)*(c_r*s_p + c_p*s_q*s_r) + c_q*c_t(3)*s_r) + c_a(2)*c_t(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) + s_a(2)*c_t(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r))) - s_a(1)*s_t(1)*(s_a(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) - c_a(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r)))) - c_u*c_v*(s_a(1)*(s_t(2)*(c_a(3)*s_t(3)*(c_p*c_r - s_p*s_q*s_r) - s_a(3)*s_t(3)*(c_r*s_p + c_p*s_q*s_r) + c_q*c_t(3)*s_r) + c_a(2)*c_t(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) + s_a(2)*c_t(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r))) + c_a(1)*(s_a(2)*(c_q*s_r*s_t(3) - c_a(3)*c_t(3)*(c_p*c_r - s_p*s_q*s_r) + s_a(3)*c_t(3)*(c_r*s_p + c_p*s_q*s_r)) - c_a(2)*(c_a(3)*(c_r*s_p + c_p*s_q*s_r) + s_a(3)*(c_p*c_r - s_p*s_q*s_r)))))/((c_w*s_u + c_u*s_v*s_w)*(s_t(1)*(c_t(2)*(c_t(3)*s_q + c_a(3)*c_q*s_p*s_t(3) + c_p*c_q*s_a(3)*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p) + c_a(2)*s_t(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3))) - c_a(1)*c_t(1)*(s_a(2)*c_t(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p) - s_t(2)*(c_t(3)*s_q + c_a(3)*c_q*s_p*s_t(3) + c_p*c_q*s_a(3)*s_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3))) + s_a(1)*c_t(1)*(s_a(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3)) - c_a(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p))) + (s_u*s_w - c_u*c_w*s_v)*(c_t(1)*(c_t(2)*(c_t(3)*s_q + c_a(3)*c_q*s_p*s_t(3) + c_p*c_q*s_a(3)*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p) + c_a(2)*s_t(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3))) + c_a(1)*s_t(1)*(s_a(2)*c_t(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p) - s_t(2)*(c_t(3)*s_q + c_a(3)*c_q*s_p*s_t(3) + c_p*c_q*s_a(3)*s_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3))) - s_a(1)*s_t(1)*(s_a(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3)) - c_a(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p))) - c_u*c_v*(c_a(1)*(s_a(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3)) - c_a(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p)) + s_a(1)*(s_a(2)*c_t(2)*(c_a(3)*c_p*c_q - c_q*s_a(3)*s_p) - s_t(2)*(c_t(3)*s_q + c_a(3)*c_q*s_p*s_t(3) + c_p*c_q*s_a(3)*s_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_q*c_t(3)*s_p - s_q*s_t(3) + c_p*c_q*s_a(3)*c_t(3))))));
      -asin((c_w*s_u + c_u*s_v*s_w)*(s_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - s_a(1)*c_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*c_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) + (s_u*s_w - c_u*c_w*s_v)*(c_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + s_a(1)*s_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - c_a(1)*s_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) + c_u*c_v*(s_a(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))));
      atan(((c_u*c_w - s_u*s_v*s_w)*(s_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - s_a(1)*c_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*c_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) + (c_u*s_w + c_w*s_u*s_v)*(c_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + s_a(1)*s_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - c_a(1)*s_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) - c_v*s_u*(s_a(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))))/(s_v*(s_a(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) + c_v*c_w*(c_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + s_a(1)*s_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - c_a(1)*s_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q)))) - c_v*s_w*(s_t(1)*(c_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) - c_a(2)*s_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + s_a(2)*s_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) - s_a(1)*c_t(1)*(s_a(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) + c_a(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))) + c_a(1)*c_t(1)*(s_t(2)*(s_a(3)*s_t(3)*(s_p*s_r - c_p*c_r*s_q) - c_a(3)*s_t(3)*(c_p*s_r + c_r*s_p*s_q) + c_q*c_r*c_t(3)) + c_a(2)*c_t(2)*(c_a(3)*c_t(3)*(c_p*s_r + c_r*s_p*s_q) - s_a(3)*c_t(3)*(s_p*s_r - c_p*c_r*s_q) + c_q*c_r*s_t(3)) - s_a(2)*c_t(2)*(c_a(3)*(s_p*s_r - c_p*c_r*s_q) + s_a(3)*(c_p*s_r + c_r*s_p*s_q))))))];

end
